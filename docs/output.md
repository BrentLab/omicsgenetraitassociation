# nf-core/omicsgenetraitassociation: Output

## Introduction

This document describes the output produced by the pipeline. Most of the plots are taken from the MultiQC report, which summarises results at the end of the pipeline.

In the output directory, of a given run of this pipeline, there will be a subdirectory for each sample in the samplesheet where the directory name is the sample name (first field in the samplesheet).

For example, if your samplesheet has two samples, like so:

```csv title="samplesheet.csv"
sample,trait,pascal,twas,additional_sources
llfs_fhshdl,data/llfs/gwas.csv.gz,data/llfs/twas.csv
fhs_fhshdl,data/fhs/gwas.csv.gz,data/fhs/twas.csv
```

Then the output directory would have the following structure:

```raw
example_results/
├── llfs_fhshdl
│   ├── cma/
│   ├── mmap/
│   ├── pascal/
│   ├── mea/
├── llfs_fhshdl
│   ├── cma/
│   ├── mmap/
│   ├── pascal/
│   ├── mea/
└── pipeline_info
```

## Pipeline overview

The pipeline is built using [Nextflow](https://www.nextflow.io/) and processes data using the following steps:

1. Prepare gene-level trait-association P-values

-   [PASCAL](#pascal)
-   [MMAP](#mmap)

2. Perform (correlated) Meta-Analysis

-   [CMA](#cma)

3. Enrichment Analyses

-   [MEA](#mea)
-   [GOEA](#mea)

### PASCAL

This step aggregates GWAS summary statistics P-values to gene-level scores using PASCAL which accounts for linkage between markers. It provides aggregated gene-level P-values and a manhattan plot for visualization

<details markdown="1">
<summary>Output files</summary>

-   `pascal/`
    -   `pascal_out.tsv`: PASCAL gene-level P-values
    -   `manhattan_plot.png`: manhattan plot

### MMAP

This step uses MMAP to perform linear mixed model analysis using gene expression as the main predictor and the trait as the outcome variable. It provides a directory of LMM results for each gene as well as a parsed output as a single csv file.

<details markdown="1">
<summary>Output files</summary>

-   `mmap/`
    -   `mmap/`: directory containing single-gene results
    -   `parsed_output_mmap_results.csv`: parsed output file

### CMA

This step performs correlated meta-analysis using the CMA package. It provides an output file with the meta P-value and a matrix of tetrachoric correlation coefficients.

<details markdown="1">
<summary>Output files</summary>

-   `cma/`
    -   `CMA_meta.csv`: file with meta p-value
    -   `tetrachor_sigma.txt`: tetrachoric correlations between input datasets

### MEA

This step performs module and gene ontology (GO) enrichment analyses. It provides summaries of each enrichment analysis.

<details markdown="1">
<summary>Output files</summary>

-   `mea/`
    -   `master_summary_<sample>.csv`: master summary file with all enrichment analysis results

### Pipeline information

<details markdown="1">
<summary>Output files</summary>

-   `pipeline_info/`
    -   Reports generated by Nextflow: `execution_report.html`, `execution_timeline.html`, `execution_trace.txt` and `pipeline_dag.dot`/`pipeline_dag.svg`.
    -   Reports generated by the pipeline: `pipeline_report.html`, `pipeline_report.txt` and `software_versions.yml`. The `pipeline_report*` files will only be present if the `--email` / `--email_on_fail` parameter's are used when running the pipeline.
    -   Reformatted samplesheet files used as input to the pipeline: `samplesheet.valid.csv`.
    -   Parameters used by the pipeline run: `params.json`.

</details>

[Nextflow](https://www.nextflow.io/docs/latest/tracing.html) provides excellent functionality for generating various reports relevant to the running and execution of the pipeline. This will allow you to troubleshoot errors with the running of the pipeline, and also provide you with other information such as launch commands, run times and resource usage.
